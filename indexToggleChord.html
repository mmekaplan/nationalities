<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
<!-- Styles -->
<h2> DXP Suite: Who uses what?
</h2>
<h3>
<style>
    #chartdiv {
      width: 100%;
      height: 800px;
    }
    </style>
    
   <!-- Resources -->
<script src="https://www.amcharts.com/lib/4/core.js"></script>
<script src="https://www.amcharts.com/lib/4/charts.js"></script>
<script src="https://www.amcharts.com/lib/4/themes/animated.js"></script>
<!-- Chart code -->
<script>
    am4core.ready(function() {
    
    // Themes begin
    am4core.useTheme(am4themes_animated);
    // Themes end

    
var chart = am4core.create("chartdiv", am4charts.ChordDiagram);

  // colors of main characters
chart.colors.saturation = 0.45;
chart.colors.step = 3;
var colors = {
    OpsToolkit:chart.colors.next(),
    Honeycomb:chart.colors.next(),
    JC:chart.colors.next(),
    Populator:chart.colors.next(),
    DigitalCoach:chart.colors.next(),
    SIP:chart.colors.next(),
    JourneySimulator:chart.colors.next(),
    Penumbra:chart.colors.next(),
    Lumen:chart.colors.next(),
    JourneyAdvisor:chart.colors.next(),
    SelfService:chart.colors.next(),
    // SolutionsEngineeringSRE:chart.colors.next(),
    // TechSupport:chart.colors.next(),
    // ResellersAndPartners:chart.colors.next(),
    // Sales:chart.colors.next(),
    // B2B:chart.colors.next(),
    // B2C:chart.colors.next(),
    // CallCenter:chart.colors.next()
    }



chart.data = [
// node property fields take data from data items where they are first mentioned, that's 
// why we add empty data items at the beginning and set colors here
{"from":"Ops Toolkit", "color":colors.OpsToolkit},
{"from":"Honeycomb",  "color":colors.Honeycomb},
{"from":"Digital Coach",  "color":colors.DigitalCoach},
{"from":"Synchronoss Insights Platform(SIP)", "color":colors.SIP},
{"from":"Journey Simulator",   "color":colors.JourneySimulator},
{"from":"Penumbra",  "color":colors.Penumbra},
{"from":"Lumen", "color":colors.Lumen},
{"from":"Journey Advisor",  "color":colors.JourneyAdvisor},
{"from":"Self-Service", "color":colors.SelfService},
{"from":"Lumen",  "color":colors.Lumen},
{"from":"Journey Creator",  "color":colors.JC},

// real data
// {"from":"Journey Creator","to":"Honeycomb","value":1},
// {"from":"Journey Creator","to":"Digital Coach","value":1},
// {"from":"Journey Creator","to":"Synchronoss Insights Platform(SIP)","value":1},
// {"from":"Journey Creator","to":"Journey Simulator","value":2},
// {"from":"Journey Creator","to":"Penumbra","value":2},
// {"from":"Journey Creator","to":"Lumen","value":1},
// {"from":"Journey Creator","to":"Journey Advisor","value":2},
// {"from":"Journey Creator","to":"Self-Service","value":2},
// {"from":"Journey Creator","to":"Ops Toolkit","value":1},
// {"from":"Journey Creator","to":"Solutions Engineering/SRE","value":1},

// {"from":"Honeycomb","to":"Digital Coach","value":1},

// {"from":"Digital Coach","to":"Populator","value":1},
// {"from":"Digital Coach","to":"Synchronoss Insights Platform(SIP)","value":1},
//Now for the people each component connects to
{"from":"Journey Creator","to":"Solutions Engineering/SRE","value":1},
{"from":"Journey Creator","to":"Tech Support","value":1},
{"from":"Journey Creator","to":"Resellers/Partners","value":1},
{"from":"Journey Creator","to":"Sales","value":1},
{"from":"Journey Creator","to":"B2B","value":1},
{"from":"Journey Creator","to":"B2C","value":1},
{"from":"Journey Creator","to":"Call Center","value":1},

{"from":"Honeycomb","to":"Tech Support","value":1},
{"from":"Honeycomb","to":"Resellers/Partners","value":1},
{"from":"Honeycomb","to":"Sales","value":1},
{"from":"Honeycomb","to":"B2B","value":1},
{"from":"Honeycomb","to":"B2C","value":1},
{"from":"Honeycomb","to":"Call Center","value":1},

{"from":"Populator","to":"Solutions Engineering/SRE","value":1},
{"from":"Populator","to":"Resellers/Partners","value":1},
{"from":"Populator","to":"Sales","value":1},
{"from":"Populator","to":"Tech Support","value":1},

{"from":"Digital Coach","to":"Tech Support","value":1},
{"from":"Digital Coach","to":"Resellers/Partners","value":1},
{"from":"Digital Coach","to":"Sales","value":1},
{"from":"Digital Coach","to":"B2B","value":1},
{"from":"Digital Coach","to":"B2C","value":1},
{"from":"Digital Coach","to":"Call Center","value":1},
{"from":"Digital Coach","to":"Solutions Engineering/SRE","value":1},

{"from":"Synchronoss Insights Platform(SIP)","to":"Solutions Engineering/SRE","value":1},
{"from":"Synchronoss Insights Platform(SIP)","to":"Tech Support","value":1},
{"from":"Synchronoss Insights Platform(SIP)","to":"Resellers/Partners","value":1},

{"from":"Journey Simulator","to":"Solutions Engineering/SRE","value":1},
{"from":"Journey Simulator","to":"Tech Support","value":1},
{"from":"Journey Simulator","to":"Resellers/Partners","value":1},
{"from":"Journey Simulator","to":"Sales","value":1},

{"from":"Penumbra","to":"Solutions Engineering/SRE","value":1},
{"from":"Penumbra","to":"Tech Support","value":1},

{"from":"Lumen","to":"Solutions Engineering/SRE","value":1},
{"from":"Lumen","to":"Tech Support","value":1},
{"from":"Lumen","to":"Resellers/Partners","value":1},
{"from":"Lumen","to":"B2B","value":1},
{"from":"Lumen","to":"B2C","value":1},

{"from":"Journey Advisor","to":"Tech Support","value":1},
{"from":"Journey Advisor","to":"Resellers/Partners","value":1},
{"from":"Journey Advisor","to":"B2B","value":1},
{"from":"Journey Advisor","to":"B2C","value":1},

{"from":"Self-Service","to":"B2B","value":1},
{"from":"Self-Service","to":"B2C","value":1},
{"from":"Self-Service","to":"Call Center","value":1},


{"from":"Ops Toolkit","to":"Solutions Engineering/SRE","value":1},
{"from":"Ops Toolkit","to":"Tech Support","value":1},
{"from":"Ops Toolkit","to":"B2B","value":1},
{"from":"Ops Toolkit","to":"B2C","value":1},
{"from":"Ops Toolkit","to":"Call Center","value":1}]



//Done charting connections:



chart.dataFields.fromName = "from";
chart.dataFields.toName = "to";
chart.dataFields.value = "value";


chart.nodePadding = 0.5;
chart.minNodeSize = 0.01;
chart.startAngle = 80;
chart.endAngle = chart.startAngle + 360;
chart.sortBy = "value";
chart.fontSize = 15;

var nodeTemplate = chart.nodes.template;
nodeTemplate.readerTitle = "Click to show/hide or drag to rearrange";
nodeTemplate.showSystemTooltip = true;
nodeTemplate.propertyFields.fill = "color";
nodeTemplate.tooltipText = "{name}'s connections: {total}";

// when rolled over the node, make all the links rolled-over
nodeTemplate.events.on("over", function(event) {    
    var node = event.target;
    node.outgoingDataItems.each(function(dataItem) {
        if(dataItem.toNode){
            dataItem.link.isHover = true;
            dataItem.toNode.label.isHover = true;
        }
    })
    node.incomingDataItems.each(function(dataItem) {
        if(dataItem.fromNode){
            dataItem.link.isHover = true;
            dataItem.fromNode.label.isHover = true;
        }
    }) 

    node.label.isHover = true;   
})

// when rolled out from the node, make all the links rolled-out
nodeTemplate.events.on("out", function(event) {
    var node = event.target;
    node.outgoingDataItems.each(function(dataItem) {        
        if(dataItem.toNode){
            dataItem.link.isHover = false;                
            dataItem.toNode.label.isHover = false;
        }
    })
    node.incomingDataItems.each(function(dataItem) {
        if(dataItem.fromNode){
            dataItem.link.isHover = false;
           dataItem.fromNode.label.isHover = false;
        }
    })

    node.label.isHover = false;
})

var label = nodeTemplate.label;
label.relativeRotation = 90;

label.fillOpacity = 0.4;
let labelHS = label.states.create("hover");
labelHS.properties.fillOpacity = 1;

nodeTemplate.cursorOverStyle = am4core.MouseCursorStyle.pointer;
// this adapter makes non-main character nodes to be filled with color of the main character which he/she kissed most
nodeTemplate.adapter.add("fill", function(fill, target) {
    let node = target;
    let counters = {};
    let mainChar = false;
    node.incomingDataItems.each(function(dataItem) {
        if(colors[dataItem.toName]){
            mainChar = true;
        }

        if(isNaN(counters[dataItem.fromName])){
            counters[dataItem.fromName] = dataItem.value;
        }
        else{
            counters[dataItem.fromName] += dataItem.value;
        }
    })
    if(mainChar){
        return fill;
    }

    let count = 0;
    let color;
    let biggest = 0;
    let biggestName;

    for(var name in counters){
        if(counters[name] > biggest){
            biggestName = name;
            biggest = counters[name]; 
        }        
    }
    if(colors[biggestName]){
        fill = colors[biggestName];
    }
  
    return fill;
})

// link template
var linkTemplate = chart.links.template;
linkTemplate.strokeOpacity = 0;
linkTemplate.fillOpacity = 0.15;
linkTemplate.tooltipText = "{fromName} & {toName}:{value.value}";

var hoverState = linkTemplate.states.create("hover");
hoverState.properties.fillOpacity = 0.7;
hoverState.properties.strokeOpacity = 0.7;



}); // end am4core.ready()
</script>

<!-- HTML -->
<div id="chartdiv"></div>
</body>
</html>